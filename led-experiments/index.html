<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="howler.js"></script>
<script type="text/javascript" src="simplex-noise.js"></script>
<script type="text/javascript" src="hsv.js"></script>
<script type="text/javascript" src="rings.js"></script>
<script type="text/javascript" src="lights.js"></script>
<script type="text/javascript">

$(function() {

    var songURL = "https://dl.dropboxusercontent.com/s/dwg72gzye916r7m/The%20Glitch%20Mob%20-%20We%20Can%20Make%20the%20World%20Stop.mp3?dl=1&token_hash=AAGF9W1cmy1WpBYXw_nmdnlVd9BVq-O5RfEdXlOIgpAntw&expiry=1400382086";
    var analysisURL = "tracks/The Glitch Mob - We Can Make the World Stop.json";

    $.getJSON(analysisURL, function (analysis) {

        var song = new Howl({
            urls: [songURL],
            autoplay: true,
            loop: false,
            onplay: function() {
                $('#musicStatus').text("Track playing");
            }   
        });
        $('#musicStatus').text("Loading music...");

        var lights = new Lights({
            song: song,
            analysis: analysis,
            lagAdjustment: -0.015,
            layoutURL: "grid32x16z.json",
            onconnecting: function() {
                $('#ledStatus').text("Connecting to Fadecandy LED server...");
            },
            onconnected: function() {
                $('#ledStatus').text("Connected to Fadecandy LED server");
            },
            onerror: function() {
                $('#ledStatus').text("Error connecting to LED server");
            }
        });

    });
})

</script>
</head>
<body>
    <div id="ledStatus"></div>
    <div id="musicStatus"></div>
</body>
</html>
