<!DOCTYPE html>
<html>
<head>
<script type="text/javascript" src="jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="howler.js"></script>
<script type="text/javascript" src="lights.js"></script>
<script type="text/javascript">

$(function() {

    var songURL = "https://dl.dropboxusercontent.com/s/uygfzmkwpzfy349/ISE%20-%20Inner%20Search.mp3?dl=1&token_hash=AAH7i03kTLyATumLaAGkSVgfRiAPQ4A-S9_5rorZFCl01g&expiry=1400379867";
    var analysisURL = "tracks/ISE - Inner Search.json";

    $.getJSON(analysisURL, function (analysis) {

        var song = new Howl({
            urls: [songURL],
            autoplay: true,
            loop: true,
            onplay: function() {
                $('#musicStatus').text("Track playing");
            }   
        });
        $('#musicStatus').text("Loading music...");

        var lights = new Lights({
            song: song,
            analysis: analysis,
            lagAdjustment: -0.015,
            layoutURL: "grid32x16z.json",
            onconnecting: function() {
                $('#ledStatus').text("Connecting to Fadecandy LED server...");
            },
            onconnected: function() {
                $('#ledStatus').text("Connected to Fadecandy LED server");
            },
            onerror: function() {
                $('#ledStatus').text("Error connecting to LED server");
            }
        });

    });
})

</script>
</head>
<body>
    <div id="ledStatus"></div>
    <div id="musicStatus"></div>
</body>
</html>
